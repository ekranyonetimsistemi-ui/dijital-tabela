<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“º Dijital Tabela - Admin Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Login SayfasÄ± Stilleri */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        .login-box {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            padding: 40px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .login-logo { font-size: 4em; margin-bottom: 20px; }
        .login-title { color: #333; margin-bottom: 30px; font-size: 24px; font-weight: 300; }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 8px; color: #555; font-weight: 500; }
        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8f9fa;
        }
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .login-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        .error-message {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #fcc;
            display: none;
        }
        
        /* Ana Sistem Stilleri */
        .main-system { display: none; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header {
            background: rgba(255,255,255,0.95);
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header-left { display: flex; align-items: center; gap: 20px; }
        .header-right { display: flex; gap: 10px; }
        .logo { font-size: 2em; }
        .admin-info { color: #666; font-size: 14px; }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-secondary { background: #6c757d; }
        .btn-danger { background: #dc3545; }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
        
        .section {
            background: rgba(255,255,255,0.95);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9ff;
        }
        .upload-area:hover { border-color: #5a6fd8; background: #eef4ff; }
        .upload-area.dragover { border-color: #43e97b; background: rgba(67, 233, 123, 0.1); }
        
        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .file-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        .file-card:hover { transform: translateY(-5px); }
        .file-preview {
            width: 100%;
            height: 150px;
            background: #f0f2f5;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            overflow: hidden;
        }
        .file-preview img { width: 100%; height: 100%; object-fit: cover; }
        .file-info { padding: 15px; }
        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .user-management {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        .user-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .user-list {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #43e97b;
        }
        .user-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress {
            width: 100%;
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
            display: none;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            display: none;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .notification.success { background: #27ae60; }
        .notification.error { background: #e74c3c; }
        
        #fileInput { display: none; }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Login SayfasÄ± -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <div class="login-logo">ğŸ”</div>
            <h1 class="login-title">Admin GiriÅŸi</h1>
            <p style="color: #666; margin-bottom: 30px;">Dijital Tabela YÃ¶netim Sistemi</p>
            
            <div id="loginError" class="error-message"></div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">KullanÄ±cÄ± AdÄ±</label>
                    <input type="text" id="username" name="username" required autofocus>
                </div>
                
                <div class="form-group">
                    <label for="password">Åifre</label>
                    <input type="password" id="password" name="password" required>
                </div>
                
                <button type="submit" class="login-btn">GiriÅŸ Yap</button>
            </form>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #666; font-size: 14px;">
                <strong>VarsayÄ±lan Admin:</strong><br>
                KullanÄ±cÄ±: <code>admin</code><br>
                Åifre: <code>admin123</code>
            </div>
        </div>
    </div>

    <!-- Ana Sistem -->
    <div id="mainSystem" class="main-system">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <div class="logo">ğŸ“º</div>
                    <div>
                        <h1 style="margin: 0; color: #333;">Dijital Tabela Admin Panel</h1>
                        <div class="admin-info" id="adminInfo">Admin olarak giriÅŸ yapÄ±ldÄ±</div>
                    </div>
                </div>
                <div class="header-right">
                    <button class="btn btn-secondary" onclick="showUserModal()">ğŸ‘¥ KullanÄ±cÄ± YÃ¶netimi</button>
                    <button class="btn btn-danger" onclick="logout()">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
                </div>
            </div>
            
            <!-- Ä°statistikler -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="fileCount">0</div>
                    <div>YÃ¼klenen Dosya</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="userCount">1</div>
                    <div>KayÄ±tlÄ± KullanÄ±cÄ±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">âœ…</div>
                    <div>Sistem Aktif</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">ğŸ”’</div>
                    <div>GÃ¼venli</div>
                </div>
            </div>
            
            <!-- Dosya YÃ¼kleme -->
            <div class="section">
                <h2 style="margin-bottom: 20px;">ğŸ“¤ Ä°Ã§erik YÃ¶netimi</h2>
                
                <div class="upload-area" id="uploadArea">
                    <div style="font-size: 3em; margin-bottom: 15px;">â˜ï¸</div>
                    <h3 style="margin-bottom: 15px;">DosyalarÄ± Buraya SÃ¼rÃ¼kleyin</h3>
                    <p style="color: #666; margin-bottom: 20px;">veya tÄ±klayarak seÃ§in</p>
                    <button class="btn" onclick="document.getElementById('fileInput').click()">
                        ğŸ“ Dosya SeÃ§
                    </button>
                    <p style="color: #888; margin-top: 15px; font-size: 14px;">
                        Desteklenen: JPG, PNG, GIF, MP4, MOV (Max: 10MB)
                    </p>
                </div>
                
                <input type="file" id="fileInput" multiple accept=".jpg,.jpeg,.png,.gif,.mp4,.mov">
                <div class="progress" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <div class="files-grid" id="filesGrid">
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">
                        <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“‚</div>
                        <p>HenÃ¼z iÃ§erik yÃ¼klenmemiÅŸ</p>
                    </div>
                </div>
            </div>
            
            <!-- API Bilgileri -->
            <div class="section">
                <h2 style="margin-bottom: 20px;">ğŸ¥§ Raspberry Pi API</h2>
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                    <h3 style="color: #1976d2; margin-bottom: 15px;">ğŸ“¡ API Endpoint:</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; word-break: break-all;" id="apiEndpoint">
                        https://your-app.vercel.app/api/files
                    </div>
                </div>
                <button class="btn" onclick="downloadPiClient()" style="margin-top: 15px;">
                    ğŸ¥§ Pi Client Kodunu Ä°ndir
                </button>
            </div>
        </div>
    </div>

    <!-- KullanÄ±cÄ± YÃ¶netimi Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeUserModal()">&times;</span>
            <h2 style="margin-bottom: 30px;">ğŸ‘¥ KullanÄ±cÄ± YÃ¶netimi</h2>
            
            <div class="user-management">
                <div class="user-form">
                    <h3 style="margin-bottom: 20px; color: #667eea;">â• Yeni Admin Ekle</h3>
                    <form id="addUserForm">
                        <div class="form-group">
                            <label>KullanÄ±cÄ± AdÄ±</label>
                            <input type="text" id="newUsername" required>
                        </div>
                        <div class="form-group">
                            <label>Åifre</label>
                            <input type="password" id="newPassword" required>
                        </div>
                        <div class="form-group">
                            <label>Åifre Tekrar</label>
                            <input type="password" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn">ğŸ‘¤ Admin Ekle</button>
                    </form>
                </div>
                
                <div class="user-list">
                    <h3 style="margin-bottom: 20px; color: #43e97b;">ğŸ‘¥ Mevcut Adminler</h3>
                    <div id="usersList"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // Global deÄŸiÅŸkenler
        let currentUser = null;
        let uploadedFiles = [];
        
        // Sayfa yÃ¼klendiÄŸinde
        window.addEventListener('load', () => {
            initializeSystem();
        });
        
        // Sistem baÅŸlangÄ±cÄ±
        function initializeSystem() {
            // VarsayÄ±lan admin kullanÄ±cÄ±sÄ±nÄ± oluÅŸtur
            initializeDefaultAdmin();
            
            // Oturum kontrolÃ¼
            checkSession();
            
            // API URL'sini gÃ¼ncelle
            updateSystemUrls();
            
            // DosyalarÄ± yÃ¼kle
            loadStoredFiles();
        }
        
        // VarsayÄ±lan admin oluÅŸtur
        function initializeDefaultAdmin() {
            let users = JSON.parse(localStorage.getItem('admin_users') || '[]');
            
            if (users.length === 0) {
                users.push({
                    id: 1,
                    username: 'admin',
                    password: 'admin123',
                    role: 'admin',
                    created: new Date().toISOString()
                });
                localStorage.setItem('admin_users', JSON.stringify(users));
            }
        }
        
        // Oturum kontrolÃ¼
        function checkSession() {
            const session = localStorage.getItem('admin_session');
            if (session) {
                const sessionData = JSON.parse(session);
                currentUser = sessionData;
                showMainSystem();
            } else {
                showLoginPage();
            }
        }
        
        // Login sayfasÄ±nÄ± gÃ¶ster
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainSystem').style.display = 'none';
        }
        
        // Ana sistemi gÃ¶ster
        function showMainSystem() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainSystem').style.display = 'block';
            
            if (currentUser) {
                document.getElementById('adminInfo').textContent = 
                    `${currentUser.username} olarak giriÅŸ yapÄ±ldÄ±`;
            }
            
            updateUserCount();
        }
        
        // Login form iÅŸlemi
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (authenticateUser(username, password)) {
                // Oturum oluÅŸtur
                const sessionData = {
                    username: username,
                    role: 'admin',
                    loginTime: new Date().toISOString()
                };
                
                localStorage.setItem('admin_session', JSON.stringify(sessionData));
                currentUser = sessionData;
                
                showMainSystem();
                showNotification('âœ… BaÅŸarÄ±yla giriÅŸ yapÄ±ldÄ±!', 'success');
            } else {
                showLoginError('âŒ GeÃ§ersiz kullanÄ±cÄ± adÄ± veya ÅŸifre!');
            }
        });
        
        // KullanÄ±cÄ± doÄŸrulama
        function authenticateUser(username, password) {
            const users = JSON.parse(localStorage.getItem('admin_users') || '[]');
            return users.some(user => user.username === username && user.password === password);
        }
        
        // Login hatasÄ± gÃ¶ster
        function showLoginError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }
        
        // Ã‡Ä±kÄ±ÅŸ yap
        function logout() {
            if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinizden emin misiniz?')) {
                localStorage.removeItem('admin_session');
                currentUser = null;
                showLoginPage();
                
                // Form alanlarÄ±nÄ± temizle
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                showNotification('ğŸ‘‹ BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yapÄ±ldÄ±!', 'success');
            }
        }
        
        // KullanÄ±cÄ± modalÄ±nÄ± gÃ¶ster
        function showUserModal() {
            document.getElementById('userModal').style.display = 'block';
            loadUsersList();
        }
        
        // KullanÄ±cÄ± modalÄ±nÄ± kapat
        function closeUserModal() {
            document.getElementById('userModal').style.display = 'none';
        }
        
        // KullanÄ±cÄ± listesini yÃ¼kle
        function loadUsersList() {
            const users = JSON.parse(localStorage.getItem('admin_users') || '[]');
            const usersList = document.getElementById('usersList');
            
            usersList.innerHTML = users.map(user => `
                <div class="user-item">
                    <div>
                        <strong>ğŸ‘¤ ${user.username}</strong><br>
                        <small style="color: #666;">${user.role} â€¢ ${new Date(user.created).toLocaleDateString()}</small>
                    </div>
                    <div>
                        ${user.username !== 'admin' ? `<button class="btn btn-danger" onclick="deleteUser(${user.id})" style="font-size: 12px; padding: 5px 10px;">ğŸ—‘ï¸ Sil</button>` : '<span style="color: #666; font-size: 12px;">Ana Admin</span>'}
                    </div>
                </div>
            `).join('');
        }
        
        // Yeni kullanÄ±cÄ± ekleme
        document.getElementById('addUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validasyon
            if (password !== confirmPassword) {
                showNotification('âŒ Åifreler eÅŸleÅŸmiyor!', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('âŒ Åifre en az 6 karakter olmalÄ±!', 'error');
                return;
            }
            
            // KullanÄ±cÄ± adÄ± kontrolÃ¼
            const users = JSON.parse(localStorage.getItem('admin_users') || '[]');
            if (users.some(user => user.username === username)) {
                showNotification('âŒ Bu kullanÄ±cÄ± adÄ± zaten mevcut!', 'error');
                return;
            }
            
            // Yeni kullanÄ±cÄ± ekle
            const newUser = {
                id: Date.now(),
                username: username,
                password: password,
                role: 'admin',
                created: new Date().toISOString()
            };
            
            users.push(newUser);
            localStorage.setItem('admin_users', JSON.stringify(users));
            
            // Formu temizle
            document.getElementById('addUserForm').reset();
            
            // Listeyi gÃ¼ncelle
            loadUsersList();
            updateUserCount();
            
            showNotification(`âœ… ${username} admin olarak eklendi!`, 'success');
        });
        
        // KullanÄ±cÄ± silme
        function deleteUser(userId) {
            if (confirm('Bu kullanÄ±cÄ±yÄ± silmek istediÄŸinizden emin misiniz?')) {
                let users = JSON.parse(localStorage.getItem('admin_users') || '[]');
                users = users.filter(user => user.id !== userId);
                localStorage.setItem('admin_users', JSON.stringify(users));
                
                loadUsersList();
                updateUserCount();
                
                showNotification('ğŸ—‘ï¸ KullanÄ±cÄ± silindi!', 'success');
            }
        }
        
        // KullanÄ±cÄ± sayÄ±sÄ±nÄ± gÃ¼ncelle
        function updateUserCount() {
            const users = JSON.parse(localStorage.getItem('admin_users') || '[]');
            document.getElementById('userCount').textContent = users.length;
        }
        
        // Sistem URL'lerini gÃ¼ncelle
        function updateSystemUrls() {
            const currentUrl = window.location.origin;
            document.getElementById('apiEndpoint').textContent = currentUrl + '/api/files';
        }
        
        // Dosya yÃ¼kleme ve yÃ¶netimi (Ã¶nceki kodlar)
        function loadStoredFiles() {
            const storedFiles = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
            updateFileDisplay(storedFiles);
            updateFileCount(storedFiles.length);
        }
        
        function updateFileCount(count) {
            document.getElementById('fileCount').textContent = count;
        }
        
        function updateFileDisplay(files) {
            const grid = document.getElementById('filesGrid');
            
            if (files.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">
                        <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“‚</div>
                        <p>HenÃ¼z iÃ§erik yÃ¼klenmemiÅŸ</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = files.map((file, index) => `
                <div class="file-card">
                    <div class="file-preview">
                        ${file.type === 'image' 
                            ? `<img src="${file.data}" alt="${file.name}" loading="lazy">` 
                            : `<div style="color: #667eea;">ğŸ¥</div>`
                        }
                    </div>
                    <div class="file-info">
                        <div style="font-weight: bold; margin-bottom: 8px;">
                            ${file.name.length > 25 ? file.name.substring(0, 25) + '...' : file.name}
                        </div>
                        <div style="color: #666; font-size: 12px; margin-bottom: 10px;">
                            ${file.type === 'image' ? 'ğŸ–¼ï¸ FotoÄŸraf' : 'ğŸ¥ Video'} â€¢ ${(file.size / 1024 / 1024).toFixed(2)} MB
                        </div>
                        <button class="delete-btn" onclick="deleteFile(${index})">ğŸ—‘ï¸ Sil</button>
                    </div>
                </div>
            `).join('');
        }
        
        // Drag & Drop ve dosya yÃ¼kleme
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });
        
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
        
        async function handleFiles(files) {
            for (let file of files) {
                await uploadFile(file);
            }
        }
        
        async function uploadFile(file) {
            if (file.size > 10 * 1024 * 1024) {
                showNotification('âŒ Dosya Ã§ok bÃ¼yÃ¼k! Maksimum 10MB', 'error');
                return;
            }
            
            const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'video/mp4', 'video/quicktime'];
            if (!allowedTypes.includes(file.type)) {
                showNotification('âŒ Desteklenmeyen dosya tÃ¼rÃ¼!', 'error');
                return;
            }
            
            try {
                showProgress(true);
                
                const base64Data = await fileToBase64(file);
                
                const fileInfo = {
                    name: file.name,
                    type: file.type.startsWith('image/') ? 'image' : 'video',
                    size: file.size,
                    data: base64Data,
                    uploadDate: new Date().toISOString(),
                    uploadedBy: currentUser.username
                };
                
                const storedFiles = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
                storedFiles.push(fileInfo);
                localStorage.setItem('uploadedFiles', JSON.stringify(storedFiles));
                
                showProgress(false);
                showNotification(`âœ… ${file.name} yÃ¼klendi!`, 'success');
                
                updateFileDisplay(storedFiles);
                updateFileCount(storedFiles.length);
                
            } catch (error) {
                showProgress(false);
                showNotification('âŒ YÃ¼kleme hatasÄ±!', 'error');
            }
        }
        
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
        
        function deleteFile(index) {
            if (confirm('Bu dosyayÄ± silmek istediÄŸinizden emin misiniz?')) {
                const storedFiles = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
                storedFiles.splice(index, 1);
                localStorage.setItem('uploadedFiles', JSON.stringify(storedFiles));
                
                updateFileDisplay(storedFiles);
                updateFileCount(storedFiles.length);
                showNotification('ğŸ—‘ï¸ Dosya silindi!', 'success');
            }
        }
        
        function showProgress(show) {
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            
            if (show) {
                progressBar.style.display = 'block';
                progressFill.style.width = '0%';
                
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 90) progress = 90;
                    progressFill.style.width = progress + '%';
                }, 100);
                
                progressBar.interval = interval;
            } else {
                if (progressBar.interval) clearInterval(progressBar.interval);
                progressFill.style.width = '100%';
                setTimeout(() => progressBar.style.display = 'none', 500);
            }
        }
        
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => notification.style.display = 'none', 3000);
        }
        
        function downloadPiClient() {
            const currentUrl = window.location.origin;
            
            const piClientCode = `#!/usr/bin/env python3
# admin_pi_client.py - Admin KorumalÄ± Dijital Tabela Client
import requests
import time
import os
import base64
from pathlib import Path

class AdminSignageClient:
    def __init__(self, api_url, device_name="Pi-Client"):
        self.api_url = api_url
        self.device_name = device_name
        self.content_dir = Path('admin_content')
        self.content_dir.mkdir(exist_ok=True)
        
    def get_files_from_api(self):
        """Admin sisteminden dosya listesi al"""
        try:
            print("ğŸ“¡ Admin sistemine baÄŸlanÄ±yor...")
            
            # GerÃ§ek implementasyonda admin API endpoint'i kullanÄ±lacak
            # Åimdilik mock data
            return []
            
        except Exception as e:
            print(f"âŒ API hatasÄ±: {e}")
            return []
    
    def display_slideshow(self):
        """Slayt gÃ¶sterisi"""
        print("ğŸ¬ Admin korumalÄ± dijital tabela Ã§alÄ±ÅŸÄ±yor...")
        print(f"ğŸ“± Cihaz: {self.device_name}")
        print(f"ğŸ”’ GÃ¼venli baÄŸlantÄ± aktif")
        
        time.sleep(5)
    
    def run(self):
        """Ana dÃ¶ngÃ¼"""
        print("ğŸš€ Admin Pi Client baÅŸlatÄ±ldÄ±")
        print("ğŸ” GÃ¼venli sistem aktif")
        print("=" * 50)
        
        while True:
            try:
                files = self.get_files_from_api()
                self.display_slideshow()
                
                print("â° 2 dakika bekleniyor...")
                time.sleep(120)
                
            except KeyboardInterrupt:
                print("\\nğŸ‘‹ Client kapatÄ±lÄ±yor...")
                break
            except Exception as e:
                print(f"âŒ Hata: {e}")
                time.sleep(60)

if __name__ == "__main__":
    # Admin sistemi URL'nizi buraya yazÄ±n
    API_URL = "${currentUrl}/api/files"
    DEVICE_NAME = "Pi-MaÄŸaza-1"
    
    client = AdminSignageClient(API_URL, DEVICE_NAME)
    client.run()
`;
            
            const blob = new Blob([piClientCode], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'admin_pi_client.py';
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('ğŸ¥§ Admin Pi Client kodu indirildi!', 'success');
        }
        
        // Modal dÄ±ÅŸÄ±na tÄ±klayÄ±nca kapat
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('userModal');
            if (event.target === modal) {
                closeUserModal();
            }
        });
    </script>
</body>
</html>
